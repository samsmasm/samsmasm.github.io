<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" type="image/png" href="/unisamicon2.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Griz - Trivia Board</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        /* --- CSS STYLES --- */
        :root {
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --accent-color: #0645ad;
            --text-color: #ffffff;
            --highlight-color: #f1c40f;
            --active-team-bg: #2ecc71;
            --wrong-color: #e74c3c;
            --timer-color: #ff4757;
            --modal-overlay: rgba(0, 0, 0, 0.95);
            --font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: var(--font-main);
            background-color: var(--bg-color);
            color: var(--text-color);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .hidden { display: none !important; }
        .container { width: 100%; height: 100%; display: flex; flex-direction: column; padding: 10px; }

        /* --- SETUP VIEW --- */
        #setup-view {
            max-width: 900px;
            margin: 0 auto;
            height: 100%;
            width: 100%;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 { margin: 0; color: var(--highlight-color); text-transform: uppercase; font-size: 3rem; }
        
        .setup-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            width: 100%;
            margin-bottom: 20px;
            background: #222;
            padding: 20px;
            border-radius: 8px;
        }

        .setting-group { margin-bottom: 15px; }
        .setting-group label { display: block; color: #aaa; font-size: 0.8rem; margin-bottom: 5px; }

        .team-setup-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
        
        .team-setup-grid input, select, .decay-input {
            padding: 8px; background: #333; border: 1px solid #555; color: white; border-radius: 4px; width: 100%;
        }

        textarea {
            width: 100%; flex: 1; min-height: 150px; background: #2a2a2a; color: #ddd; border: 2px solid #444;
            padding: 15px; font-family: monospace; border-radius: 8px; resize: none; margin-bottom: 20px;
        }

        .btn-group { display: flex; gap: 15px; width: 100%; justify-content: center; flex-wrap: wrap;}
        button { padding: 12px 24px; font-size: 1rem; cursor: pointer; border: none; border-radius: 4px; font-weight: bold; }
        
        .btn-primary { background-color: var(--highlight-color); color: #000; }
        .btn-secondary { background-color: #444; color: #fff; }
        .btn-pass { background-color: #e67e22; color: #fff; }
        .btn-wrong { background-color: var(--wrong-color); color: white; }
        .btn-math { background-color: #9b59b6; color: white; }
        
        /* --- GAME VIEW --- */
        #game-view { height: 100vh; display: flex; flex-direction: column; }
        .top-bar { display: flex; justify-content: space-between; align-items: center; padding: 10px 20px; background: #111; }

        #scoreboard { display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; }

        .team-card {
            background: #333; padding: 10px 15px; border-radius: 6px; text-align: center; border: 2px solid transparent; min-width: 120px; position: relative;
        }
        .team-card.active {
            background: #004d00; border-color: var(--active-team-bg); box-shadow: 0 0 15px rgba(46, 204, 113, 0.3); transform: scale(1.05); z-index: 2;
        }
        .team-name { 
            font-size: 3rem;      /* Increased from 0.9rem to match points */
            color: white;           /* Changed from #ccc to make it pop */
            margin-bottom: 5px; 
            font-weight: bold;
            line-height: 1.1;       /* Keeps lines tight if name wraps */
            word-wrap: break-word;  /* Ensures long names don't break layout */
        }

        .team-points { 
            font-size: 3rem; 
            font-weight: bold; 
            color: var(--highlight-color); /* Made yellow to distinguish from name */
        }
        .btn-manual-add {
            position: absolute; top: -8px; right: -8px; width: 24px; height: 24px; background: #555; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer;
        }

        #board-container { flex: 1; padding: 20px; overflow: hidden; }
        #board { display: grid; gap: 15px; height: 100%; width: 100%; }

        .cat-header {
            color: white; padding: 10px; display: flex; align-items: center; justify-content: center; text-align: center; font-weight: bold; text-transform: uppercase; border: 2px solid #fff; font-size: clamp(1rem, 2.5vh, 1.8rem); text-shadow: 1px 1px 3px rgba(0,0,0,0.8);
        }

        .tile {
            background-color: var(--accent-color); color: var(--highlight-color); font-size: clamp(2rem, 5vh, 4rem); font-weight: 900; display: flex; align-items: center; justify-content: center; cursor: pointer; text-shadow: 2px 2px 0 #000;
        }
        .tile.used { background-color: #1a1a1a; color: transparent; text-shadow: none; cursor: default; pointer-events: none; }

        /* --- MODALS --- */
        .modal { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: var(--modal-overlay); display: flex; align-items: center; justify-content: center; z-index: 1000; opacity: 0; pointer-events: none; transition: opacity 0.3s ease; }
        .modal.active { opacity: 1; pointer-events: all; }

        .modal-content {
            background: var(--accent-color); border: 4px solid var(--highlight-color); width: 95%; max-width: 1100px; padding: 30px; text-align: center; display: flex; flex-direction: column; align-items: center; border-radius: 10px; position: relative;
        }

        .modal-header-nav { display: flex; justify-content: space-between; align-items: center; width: 100%; margin-bottom: 20px; }
        .btn-skip { background: rgba(255,255,255,0.1); color: #ccc; padding: 8px 16px; font-size: 0.9rem; border: 1px solid #555; cursor: pointer; border-radius: 4px; }
        .btn-skip:hover { background: var(--wrong-color); color: white; border-color: white; }
        .active-team-indicator { background: rgba(0,0,0,0.4); color: var(--highlight-color); padding: 8px 20px; border-radius: 20px; font-weight: bold; border: 1px solid var(--highlight-color); font-size: 1.1rem; }
        .live-reward-container { background: var(--timer-color); color: white; padding: 8px 20px; border-radius: 20px; font-weight: bold; box-shadow: 0 0 10px rgba(0,0,0,0.5); min-width: 140px; }
        
        #modal-category-label {
            font-size: 1.2rem; letter-spacing: 2px; text-transform: uppercase; font-weight: bold; margin-bottom: 10px; padding: 5px 15px; border-radius: 4px; background: #333; display: inline-block; text-shadow: 1px 1px 2px black; color: white; border: 1px solid white;
        }

        .q-text { font-size: clamp(1.8rem, 4vw, 3rem); font-weight: bold; text-transform: uppercase; margin: 20px 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
        .answer-box { margin: 20px 0; padding: 20px; background: rgba(0,0,0,0.3); border-radius: 8px; width: 100%; font-size: 2rem; color: var(--highlight-color); min-height: 60px; display: flex; align-items: center; justify-content: center; }

        /* MATH UI */
        #math-answer-input { background: #000; border: 4px solid var(--highlight-color); color: white; font-size: 4rem; width: 300px; text-align: center; padding: 10px; border-radius: 10px; margin: 20px 0; outline: none; }
        #math-answer-input.correct-flash { border-color: var(--active-team-bg); background: #003300; }
        #math-answer-input.wrong-flash { border-color: var(--wrong-color); background: #330000; }
        .tt-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin: 20px 0; width: 100%; max-width: 600px; }
        .tt-btn { background: #333; color: white; padding: 15px; font-size: 1.5rem; border: 2px solid #555; border-radius: 8px; cursor: pointer; text-align: center;}
        .tt-btn.selected { background: #9b59b6; border-color: white; }

        #winner-modal .modal-content {
            background: linear-gradient(45deg, #ff0000, #ff7300, #fffb00, #48ff00, #00ffd5, #002bff, #7a00ff, #ff00c8, #ff0000);
            background-size: 400%; animation: rainbow 20s linear infinite; border: 5px solid white; color: white;
        }
        @keyframes rainbow { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .winner-text { font-size: 4rem; font-weight: 900; }
        
        .modal-controls { margin-top: 20px; width: 100%; display: flex; justify-content: center; }
    </style>
</head>
<body>

    <div id="setup-view" class="container">
        <div style="text-align: center; margin-bottom: 30px;">
            <h1 style="margin-bottom: 5px;">Griz</h1>
            <a href="https://chatgpt.com/g/g-6973624af8988191af4fa3a6f78f968a-griz-csv-generator" 
               target="_blank" 
               style="color: var(--highlight-color); text-decoration: none; font-size: 1rem; font-weight: bold; opacity: 0.8; border-bottom: 1px dashed var(--highlight-color); padding-bottom: 2px; display: inline-block;">
                Get formatted questions from this custom GPT
            </a>
        </div>

        <div class="setup-controls">
            <div>
                <h3 style="margin-bottom:10px; color:#aaa;">Settings</h3>
                <div class="setting-group">
                    <label>Game Mode</label>
                    <select id="game-mode-select">
                        <option value="standard">Standard (No Negatives)</option>
                        <option value="pass">Pass/Steal (Wrong = Negative Pts)</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label>Teams</label>
                    <select id="team-count" onchange="updateTeamInputs()">
                        <option value="1">1 Player</option><option value="2" selected>2 Teams</option>
                        <option value="3">3 Teams</option><option value="4">4 Teams</option>
                        <option value="5">5 Teams</option><option value="6">6 Teams</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label>Point Decay Rate (pts / second)</label>
                    <input type="number" id="decay-rate-input" class="decay-input" value="1" min="0">
                </div>
            </div>
            <div>
                <h3 style="margin-bottom:10px; color:#aaa;">Teams</h3>
                <div id="team-inputs" class="team-setup-grid"></div>
            </div>
        </div>
        <textarea id="csv-input" placeholder="Paste CSV here..."></textarea>
        <div class="btn-group">
            <button class="btn-primary" onclick="processCSV()">Build Grid</button>
            <button class="btn-math" onclick="openMathModal()">âœ– Times Tables Tool</button>
            <button class="btn-secondary" onclick="fillExample()">Load Example</button>
        </div>
    </div>

    <div id="game-view" class="hidden">
        <div class="top-bar">
            <div id="scoreboard"></div>
            <button class="btn-secondary" onclick="resetGame()">Edit</button>
        </div>
        <div id="board-container"><div id="board"></div></div>
    </div>

    <div id="tt-modal" class="modal">
        <div class="modal-content" style="background:#222;">
            <button class="btn-close" onclick="closeMathModal()" style="position:absolute; top:10px; right:20px; color:white; background:none; font-size:2rem; border:none; cursor:pointer;">&times;</button>
            <h2>Times Table Generator</h2>
            <div class="tt-grid" id="tt-grid"></div>
            <div style="width:100%; max-width:600px; margin:20px 0;">
                <label>Rows: <span id="row-val-display" style="color:var(--highlight-color);">5</span></label>
                <input type="range" id="row-count-slider" min="3" max="10" value="5" oninput="document.getElementById('row-val-display').textContent=this.value" style="width:100%;">
            </div>
            <button class="btn-math" onclick="generateTimesTables()">Generate & Play</button>
        </div>
    </div>

    <div id="question-modal" class="modal">
        <div class="modal-content">
            
            <div class="modal-header-nav">
                <button class="btn-skip" onclick="skipQuestion()">Skip / Reset</button>
                <div class="active-team-indicator" id="modal-team-indicator">Team 1</div>
                <div class="live-reward-container">Value: <span id="live-reward-text">0</span></div>
            </div>

            <div id="modal-category-label">CATEGORY</div>
            <div id="modal-media" class="media-container"></div>
            <div id="modal-question" class="q-text"></div>
            
            <div id="standard-logic-ui">
                <div id="modal-answer" class="answer-box hidden"></div>
                
                <div class="modal-controls">
                    <div id="pre-reveal-controls" style="display:flex; gap:15px; justify-content:center;">
                        <button id="btn-reveal" class="btn-primary" onclick="revealAnswer()">Reveal Answer</button>
                        <button id="btn-pass" class="btn-pass hidden" onclick="passToNextTeam()">Pass</button>
                        <button id="btn-steal-wrong" class="btn-wrong hidden" onclick="handleStealWrong()">Wrong (-Pts)</button>
                    </div>

                    <div id="post-reveal-controls" class="hidden" style="display:flex; gap:15px; justify-content:center;">
                        <button id="btn-award" style="background:var(--active-team-bg); color:white;" onclick="awardPoints()">Correct</button>
                        <button id="btn-final-wrong" class="btn-wrong" onclick="handleFinalWrong()">Wrong</button>
                    </div>
                </div>
            </div>

            <div id="math-logic-ui" class="hidden">
                <input type="number" id="math-answer-input" placeholder="?">
                <p style="color:#aaa;">Type answer and press Enter</p>
            </div>
        </div>
    </div>

    <div id="winner-modal" class="modal">
        <div class="modal-content" style="background:transparent; border:none;">
            <div class="winner-text">WINNER!</div>
            <div id="winner-name" style="font-size:5rem; text-decoration:underline;"></div>
            <button class="btn-secondary" onclick="location.reload()">Play Again</button>
        </div>
    </div>

    <script>
        let categories = [], teams = [], activeTeamIndex = 0, currentTile = null, usedTilesCount = 0, totalTiles = 0, selectedTables = [];
        let currentLivePoints = 0, decayRate = 1, timerInterval = null;
        
        // --- TURN TRACKING VARIABLES ---
        let gameMode = 'standard'; 
        let questionStartTeam = 0; // Who picked the tile
        let passesCount = 0;       // How many times passed/wrong in this question

        const qModal = document.getElementById('question-modal'), mathInput = document.getElementById('math-answer-input');

        window.onload = () => { updateTeamInputs(); initMathGrid(); };

        function updateTeamInputs() {
            const count = document.getElementById('team-count').value;
            const container = document.getElementById('team-inputs');
            container.innerHTML = '';
            for(let i=1; i<=count; i++) {
                container.innerHTML += `<input type="text" value="Team ${i}" id="team-name-${i}">`;
            }
        }

        function initMathGrid() {
            const grid = document.getElementById('tt-grid');
            for(let i=1; i<=12; i++) {
                const b = document.createElement('div');
                b.className = 'tt-btn'; b.textContent = i;
                b.onclick = () => { b.classList.toggle('selected'); if(selectedTables.includes(i)) selectedTables = selectedTables.filter(x=>x!==i); else selectedTables.push(i); };
                grid.appendChild(b);
            }
        }

        function generateTimesTables() {
            if(selectedTables.length === 0) return alert("Select numbers.");
            const rows = document.getElementById('row-count-slider').value;
            categories = [];
            selectedTables.forEach(num => {
                let chosen = [1,2,3,4,5,6,7,8,9,10,11,12].sort(()=>Math.random()-0.5).slice(0,rows).sort((a,b)=>a-b);
                categories.push({
                    name: `x ${num}`,
                    questions: chosen.map((m, i) => ({
                        points: (i+1)*100, question: `${num} x ${m} = ?`, answer: (num*m).toString(), isMath: true
                    }))
                });
            });
            document.getElementById('tt-modal').classList.remove('active');
            initGame();
        }

        function processCSV() {
            Papa.parse(document.getElementById('csv-input').value, {
                header: true, skipEmptyLines: true,
                complete: (r) => {
                    const temp = {};
                    r.data.forEach(row => {
                        if(!temp[row.category]) temp[row.category] = [];
                        temp[row.category].push({...row, points: parseInt(row.points)});
                    });
                    categories = Object.keys(temp).map(k => ({name: k, questions: temp[k].sort((a,b)=>a.points-b.points)}));
                    initGame();
                }
            });
        }

        function initGame() {
            teams = Array.from(document.querySelectorAll('#team-inputs input')).map(i => ({name: i.value, score: 0}));
            decayRate = parseInt(document.getElementById('decay-rate-input').value) || 0;
            gameMode = document.getElementById('game-mode-select').value;
            activeTeamIndex = 0; usedTilesCount = 0;
            totalTiles = categories.reduce((a,c) => a + c.questions.length, 0);
            renderScoreboard(); renderBoard();
            document.getElementById('setup-view').classList.add('hidden');
            document.getElementById('game-view').classList.remove('hidden');
        }

        function renderBoard() {
            const b = document.getElementById('board');
            b.style.gridTemplateColumns = `repeat(${categories.length}, 1fr)`;
            b.innerHTML = '';
            
            categories.forEach((c, index) => {
                const hue = index * (360 / categories.length);
                b.innerHTML += `<div class="cat-header" style="background-color:hsl(${hue}, 80%, 45%);">${c.name}</div>`;
            });

            const maxRows = Math.max(...categories.map(c=>c.questions.length));
            for(let i=0; i<maxRows; i++) {
                categories.forEach((c, index) => {
                    const q = c.questions[i];
                    if(q) {
                        const btn = document.createElement('button');
                        btn.className = 'tile'; btn.textContent = q.points;
                        const hue = index * (360 / categories.length);
                        btn.onclick = () => openQuestion(btn, q, c.name, `hsl(${hue}, 80%, 45%)`);
                        b.appendChild(btn);
                    } else b.innerHTML += `<div></div>`;
                });
            }
        }

        function openQuestion(tile, q, catName, catColor) {
            currentTile = tile; 
            currentLivePoints = q.points;
            
            // --- NEW TURN LOGIC: RECORD STARTING STATE ---
            questionStartTeam = activeTeamIndex; 
            passesCount = 0;                     
            
            document.getElementById('live-reward-text').textContent = currentLivePoints;
            document.getElementById('modal-question').textContent = q.question;
            document.getElementById('modal-answer').textContent = q.answer;
            
            const catLabel = document.getElementById('modal-category-label');
            catLabel.textContent = catName || 'General';
            catLabel.style.backgroundColor = catColor || '#333';

            updateTurnIndicator(); 
            
            // Logic UI Reset
            const isMath = !!q.isMath; 
            const standardUI = document.getElementById('standard-logic-ui');
            const mathUI = document.getElementById('math-logic-ui');
            
            if (isMath) {
                standardUI.classList.add('hidden');
                mathUI.classList.remove('hidden');
                mathInput.value = '';
                setTimeout(() => mathInput.focus(), 100);
            } else {
                mathUI.classList.add('hidden');
                standardUI.classList.remove('hidden');
                
                // --- CONFIGURE BUTTONS FOR MODE ---
                document.getElementById('modal-answer').classList.add('hidden');
                
                // Show Pre-Reveal Panel, Hide Post-Reveal
                document.getElementById('pre-reveal-controls').classList.remove('hidden');
                document.getElementById('post-reveal-controls').classList.add('hidden');

                const btnPass = document.getElementById('btn-pass');
                const btnStealWrong = document.getElementById('btn-steal-wrong');

                if (gameMode === 'pass') {
                    // Pass Mode: Show Pass and Pre-Reveal Wrong (Steal)
                    btnPass.classList.remove('hidden');
                    btnStealWrong.classList.remove('hidden');
                    btnStealWrong.textContent = `Wrong (-${currentLivePoints})`;
                    btnPass.textContent = "Pass";
                } else {
                    // Standard Mode: Just Reveal Answer
                    btnPass.classList.add('hidden');
                    btnStealWrong.classList.add('hidden');
                }
            }

            // Start Timer
            if(timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                currentLivePoints = Math.max(0, currentLivePoints - decayRate);
                document.getElementById('live-reward-text').textContent = currentLivePoints;
                // Update dynamic button text as points drop
                if(gameMode === 'pass') {
                    document.getElementById('btn-steal-wrong').textContent = `Wrong (-${currentLivePoints})`;
                }
            }, 1000);

            qModal.classList.add('active');
        }

        function updateTurnIndicator() {
            document.getElementById('modal-team-indicator').textContent = `${teams[activeTeamIndex].name}`;
            renderScoreboard(); 
        }

        // --- BUTTON LOGIC: PASS (No points lost, Next Team) ---
        function passToNextTeam() {
            passesCount++; 
            if (passesCount >= teams.length) {
                finalizeTurn(); // Full loop, nobody knows.
            } else {
                activeTeamIndex = (activeTeamIndex + 1) % teams.length;
                updateTurnIndicator();
            }
        }

        // --- BUTTON LOGIC: WRONG/STEAL (Points Lost, Next Team) ---
        function handleStealWrong() {
            // Deduct points from CURRENT active team
            teams[activeTeamIndex].score -= currentLivePoints;
            
            passesCount++;
            if (passesCount >= teams.length) {
                finalizeTurn(); // Everyone tried and failed.
            } else {
                // Move to next team to try
                activeTeamIndex = (activeTeamIndex + 1) % teams.length;
                updateTurnIndicator();
            }
        }

        // --- BUTTON LOGIC: REVEAL (Locks Question, Moves to Final Phase) ---
        function revealAnswer() { 
            clearInterval(timerInterval); // Stop timer
            document.getElementById('modal-answer').classList.remove('hidden'); 
            
            // Switch Button Groups
            document.getElementById('pre-reveal-controls').classList.add('hidden');
            document.getElementById('post-reveal-controls').classList.remove('hidden');
            
            // Set Text for Final Buttons
            document.getElementById('btn-award').textContent = `Correct (+${currentLivePoints})`;
            
            if(gameMode === 'pass') {
                document.getElementById('btn-final-wrong').textContent = `Wrong (-${currentLivePoints})`;
            } else {
                document.getElementById('btn-final-wrong').textContent = `Wrong (0)`;
            }
        }

        // --- BUTTON LOGIC: CORRECT (Points Added, Close) ---
        function awardPoints() { 
            teams[activeTeamIndex].score += currentLivePoints; 
            finalizeTurn(); 
        }

        // --- BUTTON LOGIC: FINAL WRONG (Points Lost, Close) ---
        function handleFinalWrong() { 
            if(gameMode === 'pass') {
                teams[activeTeamIndex].score -= currentLivePoints;
            }
            finalizeTurn();
        }
        
        // --- MATH INPUT LOGIC ---
        mathInput.onkeydown = (e) => {
            if(e.key === 'Enter') {
                const correctAns = document.getElementById('modal-answer').textContent;
                if(mathInput.value === correctAns) {
                    mathInput.classList.add('correct-flash');
                    clearInterval(timerInterval);
                    setTimeout(() => { mathInput.classList.remove('correct-flash'); awardPoints(); }, 400);
                } else {
                    mathInput.classList.add('wrong-flash');
                    setTimeout(() => { mathInput.classList.remove('wrong-flash'); handleFinalWrong(); }, 400);
                }
            }
        };

        function skipQuestion() {
            finalizeTurn();
        }

        function finalizeTurn() {
            clearInterval(timerInterval);
            qModal.classList.remove('active');
            
            if(currentTile && !currentTile.classList.contains('used')) {
                currentTile.classList.add('used');
                usedTilesCount++;
            }
            
            // Reset Board Control: Next person is the one after the original picker
            activeTeamIndex = (questionStartTeam + 1) % teams.length;

            renderScoreboard();
            
            if(usedTilesCount >= totalTiles) {
                let winner = teams.reduce((prev, curr) => (prev.score > curr.score) ? prev : curr);
                document.getElementById('winner-name').textContent = winner.name;
                document.getElementById('winner-modal').classList.add('active');
            }
        }

        function renderScoreboard() {
            const s = document.getElementById('scoreboard');
            s.innerHTML = '';
            teams.forEach((t, i) => {
                s.innerHTML += `<div class="team-card ${i===activeTeamIndex?'active':''}" onclick="activeTeamIndex=${i};renderScoreboard();">
                    <div class="btn-manual-add" onclick="event.stopPropagation(); manualScore(${i})">+</div>
                    <div class="team-name">${t.name}</div><div class="team-points">${t.score}</div>
                </div>`;
            });
        }

        function manualScore(i) { const a = prompt("Points?"); if(a) { teams[i].score += parseInt(a); renderScoreboard(); } }
        function openMathModal() { document.getElementById('tt-modal').classList.add('active'); }
        function closeMathModal() { document.getElementById('tt-modal').classList.remove('active'); }
        function resetGame() { document.getElementById('game-view').classList.add('hidden'); document.getElementById('setup-view').classList.remove('hidden'); }
        
        function fillExample() { 
        document.getElementById('csv-input').value = `category,points,question,answer,type,media_url
Space,100,What planet do we live on?,Earth,text,
Space,200,What is the name of the star at the center of our solar system?,The Sun,text,
Space,300,Which planet is known as the Red Planet?,Mars,text,
Space,400,What do we call a rock that falls from space to Earth?,A meteorite,text,
Space,500,What do we call a person who travels into space?,Astronaut,text,
Animals,100,What animal is known as man's best friend?,Dog,text,
Animals,200,Which animal is the largest land animal?,Elephant,text,
Animals,300,What do you call a baby cat?,Kitten,text,
Animals,400,Which reptile is known for changing its color to blend in?,Chameleon,text,
Animals,500,What group of animals have feathers and lay eggs?,Birds,text,
Geography,100,What is the name of the country we live in?,United Kingdom,text,
Geography,200,What is the largest ocean on Earth?,Pacific Ocean,text,
Geography,300,What do we call land completely surrounded by water?,Island,text,
Geography,400,What is the capital city of France?,Paris,text,
Geography,500,What line goes around the middle of the Earth?,Equator,text,
History,100,Who were the rulers of ancient Egypt?,Pharaohs,text,
History,200,What did knights wear to protect themselves?,Armor,text,
History,300,What were castles mainly built for?,Defense,text,
History,400,Who was the first person to walk on the Moon?,Neil Armstrong,text,
History,500,What do we call a long time ago before written records?,Prehistory,text,
Science,100,What do we need to breathe to stay alive?,Oxygen,text,
Science,200,What state of matter is water when it freezes?,Solid,text,
Science,300,What force pulls objects down to the ground?,Gravity,text,
Science,400,What part of a plant makes food using sunlight?,Leaf,text,
Science,500,What gas do plants need from the air to make their food?,Carbon dioxide,text,`; 
    }
    </script>
</body>
</html>
